# ============================================================================
# PROFESSIONAL MAGIC MIRROR DASHBOARD - FULL HD (1920x1080)
# ============================================================================
# Optimized for hallway information display with Phase 2 power management
# All content fits in one view without scrolling
# ============================================================================

kiosk_mode:
  non_admin_settings:
    kiosk: true
    ignore_entity_settings: true
  entity_settings:
    - entity:
        input_boolean.kiosk_mode: 'on'
      hide_header: true
    - entity:
        input_boolean.kiosk_mode: 'off'
      hide_header: false

views:
  - title: Home
    type: sections
    max_columns: 3
    cards: []
    sections:
      # ========================================================================
      # LEFT COLUMN - Time, Weather, Camera, Calendar
      # ========================================================================
      - type: grid
        cards:
          # Clock & Key Info
          - type: horizontal-stack
            cards:
              - type: custom:digital-clock
                clock_style: digital
                clock_size: large
                time_format: HH:mm
                time_zone: Europe/Helsinki
                show_seconds: false
                date_format: DD.MM.YYYY
                no_background: false
                face_style: markers
              - type: vertical-stack
                cards:
                  - type: entity
                    entity: sensor.tesla_model_3_battery
                    name: Tesla
                    icon: mdi:car-electric
                  - type: entity
                    entity: sensor.aqara_ulko_temperature
                    name: Ulkol√§mp√∂
                    icon: mdi:thermometer
          
          # Weather & Sun/Moon
          - type: custom:horizon-card
            title: null
            moon: true
            language: fi
            fields:
              sunrise: true
              sunset: true
              dawn: false
              noon: false
              dusk: false
              moonrise: true
              moonset: false
              moon_phase: true
              time: false
          
          # Front Door Camera
          - type: custom:frigate-card
            cameras:
              - camera_entity: camera.qvr_etupiha
                hide: false
            view:
              update_cycle_camera: true
            live:
              preload: true
            performance:
              profile: high
          
          # Calendar
          - type: custom:atomic-calendar-revive
            enableModeChange: false
            entities:
              - entity: calendar.luca
                name: Luca
              - entity: calendar.perhe_kalenteri
                name: Perhe
              - entity: calendar.perhejoronen_gmail_com
                name: Joronen
            dimFinishedEvents: true
            disableCalLink: true
            showDatePerEvent: false
            showCalendarName: true
            showMonth: false
            disableEventLink: true
            showDescription: false
            showAllDayHours: false
            name: Kalenteri
            maxDaysToShow: 3
            refreshInterval: 30
            showDate: true
            showLoader: false
            showDeclined: false
            maxEventCount: 6
        column_span: 1

      # ========================================================================
      # CENTER COLUMN - Power Management & Energy
      # ========================================================================
      - type: grid
        cards:
          # Current Power & Status
          - type: horizontal-stack
            cards:
              - type: gauge
                entity: sensor.total_power_kw
                name: Teho nyt
                min: 0
                max: 17.25
                needle: true
                severity:
                  green: 0
                  yellow: 10
                  red: 14
              - type: gauge
                entity: sensor.electricity_total_price_cents
                name: Hinta nyt
                min: 0
                max: 50
                needle: true
                unit: c/kWh
                severity:
                  green: 0
                  yellow: 18
                  red: 28

          # 7-Day Consumption vs Price - THE KEY CHART!
          - type: custom:apexcharts-card
            header:
              show: true
              title: ‚ö°üí∞ Kulutus vs. Hinta 7 p√§iv√§√§
              show_states: true
              colorize_states: true
            experimental:
              color_threshold: true
            graph_span: 7d
            span:
              start: day
              offset: '-7d'
            now:
              show: false
            yaxis:
              - id: consumption
                min: 0
                decimals: 1
                opposite: false
              - id: price
                min: 0
                max: 60
                decimals: 0
                opposite: true
            apex_config:
              chart:
                height: 320
              legend:
                show: true
                position: top
              dataLabels:
                enabled: false
              stroke:
                width: [1, 3]
                curve: smooth
              tooltip:
                shared: true
                x:
                  format: 'dd.MM HH:mm'
              xaxis:
                labels:
                  format: 'dd.M'
            series:
              - entity: sensor.talon_kokonaiskulutus_tunti_kwh
                yaxis_id: consumption
                name: Tuntikulutus kWh
                type: area
                stroke_width: 1
                float_precision: 2
                color: '#EA8043'
                opacity: 0.7
                group_by:
                  func: last
                  duration: 1hour
                show:
                  legend_value: false
                  in_header: true
              - entity: sensor.electricity_total_price_cents
                yaxis_id: price
                name: Kokonaishinta c/kWh
                type: line
                float_precision: 1
                stroke_width: 3
                group_by:
                  func: last
                  duration: 1hour
                show:
                  legend_value: false
                  in_header: true
                color_threshold:
                  - value: 0
                    color: '#4ECDC4'
                  - value: 15
                    color: '#FFE66D'
                  - value: 25
                    color: '#FF9A76'
                  - value: 35
                    color: '#FF0000'

          # Today's Price Chart - 24h with extremas
          - type: custom:apexcharts-card
            header:
              show: true
              title: üí∞ S√§hk√∂n hinta t√§n√§√§n
              show_states: true
              colorize_states: true
            graph_span: 30h
            span:
              start: hour
              offset: '-2h'
            now:
              show: true
              label: Nyt
            yaxis:
              - id: price
                min: 0
                max: ~50
                decimals: 0
            apex_config:
              chart:
                height: 240
              legend:
                show: false
              dataLabels:
                enabled: false
              tooltip:
                shared: true
                x:
                  format: 'HH:mm'
              xaxis:
                labels:
                  format: 'HH:mm'
            series:
              - entity: sensor.electricity_total_price_cents
                name: Kokonaishinta
                type: column
                group_by:
                  func: last
                  duration: 1h
                show:
                  in_header: true
                  extremas: time
                color_threshold:
                  - value: 0
                    color: '#4ECDC4'
                  - value: 12
                    color: '#95E1D3'
                  - value: 16
                    color: '#FFE66D'
                  - value: 20
                    color: '#FF9A76'
                  - value: 25
                    color: '#FF6B6B'
                  - value: 35
                    color: '#FF0000'

          # Daily & Monthly Summary
          - type: horizontal-stack
            cards:
              - type: gauge
                entity: sensor.talon_kokonaiskulutus_paiva_kwh
                name: Kulutus t√§n√§√§n
                min: 0
                max: 120
                needle: true
                unit: kWh
                severity:
                  green: 0
                  yellow: 70
                  red: 95
              - type: gauge
                entity: sensor.sahko_hinnan_korjaus_kuukausi
                name: Kuukausi yhteens√§
                min: 0
                max: 500
                needle: true
                unit: '‚Ç¨'
                severity:
                  green: 0
                  yellow: 300
                  red: 420
        column_span: 1

      # ========================================================================
      # RIGHT COLUMN - Heating Control, Temperatures, Device Status
      # ========================================================================
      - type: grid
        cards:
          # Phase 2 Radiator Control Dashboard
          - type: markdown
            content: |
              ## üè† L√§mmityshallinta
              
              <ha-icon icon="mdi:home-account"></ha-icon> **Lapset kotona:** {{ states('input_boolean.kids_home') | upper }}
              
              ---
              
              ### üå°Ô∏è Huoneiden l√§mp√∂tilat
              
              | Huone | L√§mp√∂ | Patteri | Tavoite |
              |-------|-------|---------|---------|
              | üõèÔ∏è MH1 | {{ states('sensor.aqara_makuuhuone_temperature') }}¬∞C | {{ states('switch.mh1') | upper }} | {{ states('input_number.mh1_target_temp') }}¬∞C |
              | üë¶ Tuomas | {{ states('sensor.aqara_poikienhuone_temperature') }}¬∞C | {{ states('switch.shellypro4pm_ec62609fd3dc_switch_1') | upper }} | {{ states('input_number.kids_rooms_target_temp') }}¬∞C |
              | üëß Sara | {{ states('sensor.aqara_saranhuone_temperature') }}¬∞C | {{ states('switch.shellypro4pm_ec62609fd3dc_switch_0') | upper }} | {{ states('input_number.kids_rooms_target_temp') }}¬∞C |
              
              ---
              
              ‚è∞ **MH1 aikataulu:** {{ states('input_datetime.mh1_start_time')[:5] }} - {{ states('input_datetime.mh1_end_time')[:5] }}
              
              üîß **Manual override:** {{ states('input_boolean.mh1_manual_override') | upper }}
            card_mod:
              style: |
                ha-card {
                  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                  color: white;
                  font-size: 14px;
                }
                ha-markdown {
                  padding: 16px !important;
                }

          # All Room Temperatures
          - type: custom:apexcharts-card
            header:
              show: true
              title: üå°Ô∏è Huoneiden l√§mp√∂tilat 24h
              show_states: true
              colorize_states: true
            graph_span: 24h
            span:
              start: hour
            now:
              show: true
            yaxis:
              - id: temp
                min: 15
                max: 25
                decimals: 1
            apex_config:
              chart:
                height: 240
              stroke:
                width: 2
                curve: smooth
              legend:
                show: true
                position: top
              tooltip:
                shared: true
            series:
              - entity: sensor.aqara_makuuhuone_temperature
                name: MH1
                color: '#FF6B6B'
                stroke_width: 3
              - entity: sensor.aqara_poikienhuone_temperature
                name: Tuomas
                color: '#4ECDC4'
              - entity: sensor.aqara_saranhuone_temperature
                name: Sara
                color: '#FFE66D'
              - entity: sensor.aqara_olohuone_temperature
                name: Olohuone
                color: '#95E1D3'
                opacity: 0.6
              - entity: sensor.aqara_keittio_temperature
                name: Keitti√∂
                color: '#AA96DA'
                opacity: 0.6

          # Device Control Panel
          - type: entities
            title: üîå Laiteohjaus
            show_header_toggle: false
            card_mod:
              style: |
                ha-card {
                  background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
                  color: white;
                }
            entities:
              - entity: input_boolean.kids_home
                name: üë®‚Äçüë©‚Äçüëß‚Äçüë¶ Lapset kotona
                icon: mdi:home-account
              - type: divider
              - entity: switch.tesla_model_3_charger
                name: üöó Tesla lataus
                secondary_info: last-changed
              - entity: number.tesla_model_3_charging_amps
                name: Latausvirta
                icon: mdi:current-ac
              - type: divider
              - entity: switch.shellypro4pm_ec62609fd3dc_switch_2
                name: üíß L√§mminvesivaraaja
                icon: mdi:water-boiler
              - entity: climate.mitsu_ilp
                name: üî• Ilmal√§mp√∂pumppu
              - type: divider
              - entity: switch.mh1
                name: üå°Ô∏è MH1 patteri
                icon: mdi:radiator
              - entity: switch.shellypro4pm_ec62609fd3dc_switch_1
                name: üå°Ô∏è Tuomas patteri
                icon: mdi:radiator
              - entity: switch.shellypro4pm_ec62609fd3dc_switch_0
                name: üå°Ô∏è Sara patteri
                icon: mdi:radiator

          # Best Charging Window
          - type: markdown
            content: |
              ## ‚ö° Paras latausaika huomenna
              
              {{ states('sensor.best_charging_window_tomorrow') }}
              
              üïê **Aika:** {{ state_attr('sensor.best_charging_window_tomorrow', 'start_time') }} - {{ state_attr('sensor.best_charging_window_tomorrow', 'end_time') }}
              
              üí∞ **Keskihinta:** {{ state_attr('sensor.best_charging_window_tomorrow', 'average_price') }} c/kWh
              
              üíµ **S√§√§st√∂:** {{ state_attr('sensor.best_charging_window_tomorrow', 'savings') }} ‚Ç¨ verrattuna kalleimpaan
            card_mod:
              style: |
                ha-card {
                  background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);
                  font-size: 14px;
                }
                ha-markdown {
                  padding: 16px !important;
                }

          # Sauna Status (conditional)
          - type: conditional
            conditions:
              - condition: state
                entity: binary_sensor.kiuas_tilatieto
                state: 'on'
            card:
              type: horizontal-stack
              cards:
                - type: gauge
                  entity: sensor.sauna_temperature
                  name: üßñ Sauna
                  min: 10
                  max: 100
                  needle: true
                  severity:
                    green: 10
                    yellow: 60
                    red: 80
                - type: entity
                  entity: binary_sensor.doorsensor_sauna_contact
                  name: Saunan ovi
                  icon: mdi:door

        column_span: 1

# ============================================================================
# CARD-MOD STYLING (if you have card-mod installed)
# ============================================================================
# Add this to your themes for even better look:
#
# card-mod-theme: magic-mirror
# card-mod-view-yaml: |
#   .: |
#     hui-sections-view {
#       background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
#     }
